<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!--Favicon-->
    <!-- Changed by me, before:href="favicon/favicon.ico", after:href="http://liuqingwen.me/favicon/favicon.ico"  -->
    <!-- Sample: <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> -->
    <link rel="icon" href="/favicon/favicon.ico" type="image/x-icon">
    
        <script>
            //added by my blog of "liuqingwen.me"
            var url = "anhognda.com";
            var host = window.location.host;
            if(host == url || host == "www." + url) {
                document.location.href = "http://" + host;
            }
        </script>
    

    <!-- MathJax supported added by me -->
    
        <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
    

    <!-- Keywords, added by me -->
    
        <meta name="keywords" content="Godot, 开源游戏引擎, 2D游戏开发, 游戏教程, 玩家跳跃代码, platform game, 2D平台游戏,刘庆文, 博客, Godot, 游戏开发, 文章教程, Java, Python, Kotlin, Android, iOS, Swift, 安卓开发, 学习">
    

    <!--Description-->
    
        <meta name="description" content="This is a simple blog use Hexo, called Liuqingwen&#39;s last blog, all about of interesting things of Kotlin, Web, Swift, Game, 3D and life.">
    

    <!--Author-->
    
        <meta name="author" content="Liuqingwen">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Godot3游戏引擎入门之十三：实现玩家的跳跃功能并完成一个平台小游戏（上）"/>
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="A Vegetables Bird&#39;s Blog"/>

    <!--Page Cover-->
    
        <meta property="og:image" content=""/>
    

    <!-- Title -->
    
    <title>Godot3游戏引擎入门之十三：实现玩家的跳跃功能并完成一个平台小游戏（上） - A Vegetables Bird&#39;s Blog</title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/sass/main.css">


    <!-- Custom CSS added by me -->
    
<link rel="stylesheet" href="/css/custom.css">

    <!-- Calendar CSS added by me -->
    
<link rel="stylesheet" href="/css/calendar.css">


    <!--[if lt IE 8]>
        
<script src="/js/ie/html5shiv.js"></script>

    <![endif]-->

    <!--[if lt IE 8]>
        
<link rel="stylesheet" href="/sass/ie8.css">

    <![endif]-->

    <!--[if lt IE 9]>
        
<link rel="stylesheet" href="/sass/ie9.css">

    <![endif]-->

    <!-- Gallery 
    <link href="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.css" type="text/css" rel="stylesheet" /> -->
    <link href="https://cdn.bootcss.com/featherlight/1.7.13/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-97319413-1', 'auto');
        ga('send', 'pageview');

    </script>



<meta name="generator" content="Hexo 4.2.1"></head>

<body>

    <div id="wrapper">

        <!-- Menu -->
        <!-- Header -->
<header id="header">
    <!-- outer added by me, 2018-12-17, liuqingwen.me -->
    <div class="outer">
        <div>
            <ul>
                
                    <li>
                        <a href="/"><i class="fa fa-home fa-fw"></i>&nbsp;HOME</a>
                    </li>
                
                    <li>
                        <a href="/archives"><i class="fa fa-archive fa-fw"></i>&nbsp;ARCHIVES</a>
                    </li>
                
                    <li>
                        <a href="/tags"><i class="fa fa-tags fa-fw"></i>&nbsp;TAGS</a>
                    </li>
                
                    <li>
                        <a href="/about"><i class="fa fa-user fa-fw"></i>&nbsp;ABOUT</a>
                    </li>
                
                <li class="search">
                    <a href="/tags">
                        <span class="fa-stack"><i class="fa fa-square-o fa-stack-2x"></i><i class="fa fa-search fa-stack-1x"></i>&nbsp;
                        </span>SEARCH</a>
                </li>
            </ul>
        </div>
    </div>

    <div class="inner">

        <!-- Logo -->
        <!-- Changes: config.root variable added -->
        <a href="/" class="logo">
            <span class="symbol"><img src="/images/logo.png" alt="Logo" /></span>
            <span class="title">A Vegetables Bird's Blog</span>
        </a>

        <!-- Added the search icon -->
        <a href="/tags" class="logo" style="float: right; ">
            <span class="symbol"><i class="fa fa-search"></i></span>
            <!-- <img src="/tipuesearch/search.png" alt="Search" /> -->
        </a>

        <!-- Nav -->
        <nav>
            <ul>
                <li><a href="#menu">Menu</a></li>
            </ul>
        </nav>

    </div>
</header>

<!-- Menu -->
<nav id="menu">
    <h2>Menu</h2>
    <ul>
        
            <li>
                <a href="/">Home</a>
            </li>
        
            <li>
                <a href="/archives">Archives</a>
            </li>
        
            <li>
                <a href="/tags">Tags</a>
            </li>
        
            <li>
                <a href="/about">About</a>
            </li>
        
        <li style="color: #4cce18;">
            <!-- <a href="/tags">
                <span><img src="/tipuesearch/search.png" alt="Search" style="width: 2em; height: 2em; vertical-align: middle;" />Search</span>
            </a> -->
            <a href="/tags"><i class="fa fa-search"></i>&nbsp;Search Blog Content</a>
        </li>
    </ul>

    <!--Added by me, for calendar widget-->
    <div id="widget-calender-liuqingwen">
        <div class="widget tag">
    <h3 class="title">calendar</h3>
    <div id="calendar"></div>
</div>
    </div>
</nav>


        <div id="main">
            <div class="inner">

                <!-- Main Content -->
                

    
    <h1 class="title">Godot3游戏引擎入门之十三：实现玩家的跳跃功能并完成一个平台小游戏（上）</h1>
    <div class="meta">
        <span>2019-01-17</span>
        <span>  by Liuqingwen </span>
        
            <span> | Tags: <a href="/tags/Godot/">Godot</a></span>
        
        <span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> Hits</span>
        <!-- author added by me -->
    </div>


    <!-- lazy-img-loading added by me -->
    
        <span class="image main"><img src="http://liuqingwen.me/images/imgloader.gif" data-echo="godot_cover.jpg" alt="" /></span>
    


<!-- Gallery -->


<!-- Added by me..................for tipue search plugin -->
<div id="tipue_search_content" style="display: none"></div>

<!-- Content -->
<h2 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h2><p>2019 好久不见！终于见面！首先必须得提到一个好消息： Godot 3.1 Beta1 已经发布啦！这是新版本开发过程中的第一个 Beta 版，后续开发进程应该会加快，据我“夜观天象”，我们最快可能会在春节期间与 Godot 3.1 正式版见面！ :joy:</p>
<p>然而，对，还有一个然而，在我这三天的文章编写期间，第二个 Beta 版本也紧凑的发布了！看来开发速度已经是越来越快，距离正式版的发布也是指日可待了，强烈推荐大家使用最新发布的 Beta2 版本进行游戏开发，下载链接地址： <a href="https://downloads.tuxfamily.org/godotengine/3.1/beta2/" target="_blank" rel="noopener">https://downloads.tuxfamily.org/godotengine/3.1/beta2/</a> 。</p>
<p>言归正传，本文是我新年里的第一篇文章，也是我准备了很久的<strong>第三个</strong>入门小游戏：平台小游戏。加上我之前的文章里介绍过的两个小游戏：<a href="http://liuqingwen.me/blog/2018/11/30/introduction-of-godot-3-part-10-introduce-some-node-types-and-make-a-new-game-part-1/">金币收集小游戏</a>和<a href="http://liuqingwen.me/blog/2018/12/23/introduction-of-godot-3-part-11-introduce-the-particles-system-and-make-a-shooter-game-part-1/">太空射击小游戏</a>，总算是完成了 Godot 入门教程系列文章的第三种类型不同的游戏了。平台游戏是我们平时在 2D 游戏中非常常见的一种类型，在上一篇文章中我已经介绍了 Godot 中对于平台游戏的一些引擎内置的实用方法和相关运行原理，本文将继续分上下两篇，结合上一节的内容，一起讨论完成这个游戏的开发与制作，在介绍之前，请务必确保自己已经掌握了上一节的相关内容：<a href="http://liuqingwen.me/blog/2018/12/30/introduction-of-godot-3-part-12-talk-about-collision-and-move-and-collide-vs-move-and-slide-in-kinematicbody2d/">Godot3游戏引擎入门之十二：Godot碰撞理论以及KinematicBody2D的两个方法</a> 。</p>
<p>OK ，我们开始吧，本次文章上下篇将要详细讲述的内容主要包括以下几点：</p>
<ol>
<li>关于重力加速度的数学基础知识</li>
<li>简单的跳跃以及二次跳跃实现</li>
<li>精确到高度和跳跃距离的功能实现</li>
<li>游戏的主要场景与关卡、代码介绍（下）</li>
<li>几种敌人的设计和一些简单效果（下）</li>
<li>总结与前瞻（下）</li>
</ol>
<blockquote>
<p>主要内容：平台游戏中的跳跃实现<br>阅读时间： 15 分钟<br>永久链接： <a href="http://liuqingwen.me/blog/2019/01/17/introduction-of-godot-3-part-13-the-player-jump-implementation-and-make-a-platform-game-part-1/">http://liuqingwen.me/blog/2019/01/17/introduction-of-godot-3-part-13-the-player-jump-implementation-and-make-a-platform-game-part-1/</a><br>系列主页： <a href="http://liuqingwen.me/blog/introduction-of-godot-series/">http://liuqingwen.me/blog/introduction-of-godot-series/</a>  </p>
</blockquote>
<h2 id="二、正文"><a href="#二、正文" class="headerlink" title="二、正文"></a>二、正文</h2><h3 id="本篇目标"><a href="#本篇目标" class="headerlink" title="本篇目标"></a>本篇目标</h3><ol>
<li>重力加速度相关数学知识</li>
<li>简单的跳跃功能实现</li>
<li>精确高度和跨度的跳跃实现</li>
<li>二次跳跃等小功能的实现</li>
</ol>
<h3 id="基础数学理论"><a href="#基础数学理论" class="headerlink" title="基础数学理论"></a>基础数学理论</h3><p>在游戏开发中，我们不可避免地会接触到一些数学知识，比如矢量运算、矩阵操作、冲量动量等，听上去有点“高大上”，但实际上我们要做的确很少，因为游戏中涉及到的一些复杂的物理模型的数学分析，已经在游戏引擎的框架底层中都默默实现包装好了，比如碰撞图形的检测、图像材质的渲染、复杂的矩阵运算等等，而我们需要做的都是一些最基本的操作或者方法的应用，所以即使是初学者也无需有任何担心疑虑！当然，掌握一些基本的数学理论知识，能够让我们在游戏开发中得心应手、有章可循！</p>
<p>平台游戏中经常会涉及到一些关于重力加速度和速度相关的数学理论知识，所以让我们首先一起来回顾一下物理学中有关自由落体运动的数学概念。这些数学概念并不复杂，主要是一些简单的数学公式，相信大家都学习过，现在一起来温习一下吧！ :smiley:</p>

<p>
首先是最基本的加速度公式：
$$v_t = v_0 + at$$
对于自由落体，物体的初始速度 \(v_0 = 0\) ，加速度 \(a = g\) 为重力加速度，那么在平台游戏中，玩家从地面跳跃到最高位置也就是自由落体的反向运动：速度从最大速度 \(v_{max}\) 减到最小速度 \(v_{min} = 0\) 。我们可以得出从地面上升到最高点时所经历的时间为：
$$t = \frac{v_{max}}{g}$$
到达最高点后玩家开始下落，整个跳跃过程分上升和下落两部分，总时间即上升的时间和下落的时间总和，这两个时间是相等的，所以玩家跳跃后腾空的总时间为：
$$t_总 = 2 \cdot \frac{v_{max}}{g}$$
如何计算玩家跳跃后达到的最大高度呢？通过时间和重力加速度可以算出来，公式如下：
$$h_{max} = \frac{1}{2}gt^2$$
游戏中重力加速度可能是未知的，如果我们设定了玩家能跳跃的最大高度 \(h_{max}\) 以及玩家在空中的总时间 \(t_总\) ，那么我们就可以由上述公式可以得出游戏中实际的重力加速度大小：
$$t = \frac{t_总}{2}$$
$$g = \frac{2h_{max}}{t^2}$$
通过上面的两个公式我们能得出玩家起跳和落地时的最大速度（方向不同而已）： \(v_{max} = gt\) ，除此之外，我们也可以根据玩家跳跃的最大高度以及重力加速度来推算出玩家的最大速度：
$$v = gt = g\sqrt{\frac{2h}{g}} = \sqrt{2gh}$$
这里 \(v\) 代表最大速度，即 \(v_{max}\) ， \(h\) 代表最大高度，即 \(h_{max}\) 。
</p>


<p>以上是枯燥的理论知识！回到游戏中来，游戏场景中的玩家就是我们要操作的对象，而游戏场景就是一个具有重力加速度和地面的小世界，在任何时刻玩家都会有一个向下的重力加速度，如果没有障碍物玩家就会一直往下掉，所以我们需要添加静态碰撞体作为地面阻止玩家继续掉落，这个时候重力加速度虽然一直存在，但是玩家在竖直方向的速度因为地面而变为 0 ，如果我们给玩家一个向上的初始速度，那么他就可以往上跳跃了。</p>
<p><img src="jump_math.png" alt="数学理论"></p>
<p>但是，玩家不会无止境地往上升，因为受到向下的重力加速的影响，最终玩家的速度会降为 0 ，此刻也是他所到达最大高度的时刻，接下来就是往下落直到地面为止。这就是一个完整的跳跃过程，那么我们如何在代码中实现呢？又如设置合理的重力加速度和跳跃速度呢？接下来我们一一讨论并解决这些问题！</p>
<h3 id="简单跳跃实现"><a href="#简单跳跃实现" class="headerlink" title="简单跳跃实现"></a>简单跳跃实现</h3><p>首先我们来实现最简单的平台跳跃功能！根据上面的思路，分为以下几个步骤：</p>
<ol>
<li>第一步，在每一帧玩家都会有一个向下的重力加速度，也就是 <code>velocity.y += gravity</code> ，让它的垂直速度不断增加</li>
<li>第二步，移动玩家，因为与地面的碰撞玩家的垂直速度会变为 0 ，更新速度： <code>velocity = move_and_slide(velocity, FLOOR_NORMAL)</code></li>
<li>第三步，当玩家在地面上开始跳跃时，给玩家一个瞬间的向上的速度即可！</li>
</ol>
<p>根据上述步骤，我们编写代码来实现玩家跳跃，这里一定要注意<strong>速度是有正负之分的</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">extends KinematicBody2D</span><br><span class="line"></span><br><span class="line">export(float) var moveSpeed = <span class="number">300</span>   <span class="comment"># 水平移动速度</span></span><br><span class="line">export(float) var jumpSpeed = <span class="number">1500</span>  <span class="comment"># 跳跃瞬时速度</span></span><br><span class="line">export(float) var gravity = <span class="number">50</span>      <span class="comment"># 重力加速度</span></span><br><span class="line"></span><br><span class="line">const FLOOR_NORMAL = Vector2(<span class="number">0</span>, <span class="number">-1</span>) <span class="comment"># 地面法线</span></span><br><span class="line"></span><br><span class="line">onready var _sprite = $Sprite</span><br><span class="line">onready var _animationPlayer = $AnimationPlayer</span><br><span class="line"></span><br><span class="line">var velocity = Vector2()            <span class="comment"># 玩家的速度</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">func _input(event):</span><br><span class="line">    <span class="comment"># 只有在地面上的时候才能跳跃</span></span><br><span class="line">    <span class="keyword">if</span> self.is_on_floor() &amp;&amp; event.is_action_pressed(<span class="string">'jump'</span>):</span><br><span class="line">        velocity.y = -jumpSpeed</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">func _physics_process(delta):</span><br><span class="line">    <span class="comment"># 垂直速度不断地受重力的影响</span></span><br><span class="line">    velocity.y += gravity</span><br><span class="line">    <span class="comment"># 水平移动控制</span></span><br><span class="line">    var hDir = int(Input.is_action_pressed(<span class="string">'ui_right'</span>)) - int(Input.is_action_pressed(<span class="string">'ui_left'</span>))</span><br><span class="line">    velocity.x = hDir * moveSpeed</span><br><span class="line">    <span class="comment"># 这里一定要给速度重新赋值以及设置地面的法线参数</span></span><br><span class="line">    velocity = self.move_and_slide(velocity, FLOOR_NORMAL)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> hDir == <span class="number">1</span>:</span><br><span class="line">        sprite.flip_h = false</span><br><span class="line">    <span class="keyword">elif</span> hDir == <span class="number">-1</span>:</span><br><span class="line">        sprite.flip_h = true</span><br><span class="line"></span><br><span class="line">    _setAnimation()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">func _setAnimation():</span><br><span class="line">    <span class="keyword">if</span> ! self.is_on_floor():</span><br><span class="line">        animationPlayer.current_animation = <span class="string">'jump'</span></span><br><span class="line">    <span class="keyword">elif</span> velocity.x != <span class="number">0</span>:</span><br><span class="line">        animationPlayer.current_animation = <span class="string">'run'</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        animationPlayer.current_animation = <span class="string">'idle'</span></span><br></pre></td></tr></table></figure>

<p>代码和逻辑都很简单，这就是最简单直接的玩家跳跃功能实现，代码中关于 <code>move_and_slide()</code> 以及 <code>is_on_floor()</code> 方法的使用介绍可以参考我的上一篇文章：<a href="http://liuqingwen.me/blog/2018/12/30/introduction-of-godot-3-part-12-talk-about-collision-and-move-and-collide-vs-move-and-slide-in-kinematicbody2d/">Godot3游戏引擎入门之十二：Godot碰撞理论以及KinematicBody2D的两个方法</a>。</p>
<p>其中有三个重要的参数，参数的值在<strong>每个游戏中都不一样，同一个游戏也可以有不同的设置</strong>：</p>
<ol>
<li><code>moveSpeed</code> 水平移动速度，这个数值很好设置，结合动画感觉合理就可以</li>
<li><code>jumpSpeed</code> 垂直跳跃的初始速度，设置过大会导致跳跃过高，而太小则没有跳跃效果</li>
<li><code>gravity</code> 重力加速度，设置过大导致跳跃时间很短且水平跨度很小，过低则导致漂浮</li>
</ol>
<p>你可能会想，是不是只要调整一下 <code>jumpSpeed</code> 和 <code>gravity</code> 这两个参数的值就好了呢？其实不然！这两个值固然重要，是控制<strong>跳跃高度</strong>和<strong>腾空时间</strong>具体效果的关键，但是进一步想想，如果你需要通过跳跃跨过一段峡谷，从起跳到落地的时间，也就是空中的时间过短的话，那么你的移动速度必须足够大才能成功跨过去；如果你在空中的时间过长，那么要成功跨越一段峡谷，你的速度就必须设置很小。看来这三个参数是相辅相成的，调整一个参数必然会引起其他参数的变动！嗯……</p>
<p>那么如何解决这个问题呢？——别急，自然有办法，因为远在 17 世纪，牛顿就已经帮我们解决了，哈哈！ :grin:</p>
<h3 id="精确的实现方法"><a href="#精确的实现方法" class="headerlink" title="精确的实现方法"></a>精确的实现方法</h3><p>精确的实现，我们需要协调一些重要参数，具体的思路是这样的：首先设置最大的跳跃宽度，以及最大的跳跃高度，有了这两个值，还不够，我们还需要一个时间，即你跨过<strong>最大跨越宽度</strong>的总时间，这个时间也是玩家在空中上升和下落过程经历的总时间，这个值其实很好捕捉，凭感觉就行，举个例子，在经典小霸王游戏<em>超级玛丽</em>中的主角的最大跳跃高度是 <strong>4</strong> 个砖头，最大跨越宽度也是 <strong>4</strong> 块砖，跨越最大宽度的时间大约 <strong>1</strong> 秒钟（凭我 20 多年前的记忆猜测）。</p>
<p>这些参数设置说明如下：</p>
<ol>
<li>跨越最大宽度时间： <code>jumpDuration = 2 * t</code> ，根据游戏场景凭感觉自由设置、调整，可以得出腾空的半程时间 <code>t = jumpDuration / 2</code></li>
<li>设置最大跳跃宽度： <code>maxJumpWidth = velocity.x * t</code> 设置了 <code>maxJumpWidth</code> 后可以算出水平移动速度 <code>moveSpeed = velocity.x</code></li>
<li>设置最大跳跃高度： <code>maxJumpHeight = 1/2 * gravity * t * t</code> 这里 <code>maxJumpHeight</code> 设置后可以推算出重力加速度 <code>gravity</code></li>
<li>计算跳跃最大速度： <code>maxJumpSpeed = gravity * t</code> 请注意速度的方向，起跳速度 <code>maxJumpSpeed</code> 在 Godot 中取值为负</li>
<li>如果只是已知跳跃高度和重力加速度，可以使用 <code>v * v = 2gh</code> 的公式计算跳跃速度： <code>v = sqrt(2 * gravity * jumpHeight)</code></li>
</ol>
<p>这种设置方式就是我们要讨论的<strong>精确实现方法</strong>，设置相关变量，接下来在 <code>_ready()</code> 方法或者 <code>_init()</code> 方法中进行计算供后续代码使用，核心部分如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">extends KinematicBody2D</span><br><span class="line"></span><br><span class="line"><span class="comment"># 省略一些代码……</span></span><br><span class="line"></span><br><span class="line">const UNIT = <span class="number">16</span>                  <span class="comment"># 根据你的地图进行设置</span></span><br><span class="line"></span><br><span class="line">var gravity = <span class="number">0.0</span>                <span class="comment"># 计算获取</span></span><br><span class="line">var moveSpeed = <span class="number">0.0</span>              <span class="comment"># 计算获取</span></span><br><span class="line">var maxJumpSpeed = <span class="number">0.0</span>           <span class="comment"># 计算获取</span></span><br><span class="line">var maxJumpHeight = <span class="number">4.25</span> * UNIT</span><br><span class="line">var maxJumpWidth = <span class="number">5.25</span> * UNIT</span><br><span class="line">var jumpDuration = <span class="number">1.0</span>           <span class="comment"># 跨越总时间，即 2t</span></span><br><span class="line"></span><br><span class="line">var velocity = Vector2()         <span class="comment"># 计算获取</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">func _ready():</span><br><span class="line">    gravity = <span class="number">2</span> * maxJumpHeight / (jumpDuration / <span class="number">2</span> * jumpDuration / <span class="number">2</span>)</span><br><span class="line">    moveSpeed = maxJumpWidth / jumpDuration</span><br><span class="line">    maxJumpSpeed = - gravity * jumpDuration / <span class="number">2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">func _physics_process(delta):</span><br><span class="line">    <span class="comment"># 省略代码部分，请参考之前的代码</span></span><br></pre></td></tr></table></figure>

<p>代码还是非常简单，大部分保持不变，另外，我这里定义的常量 <code>UNIT</code> 表示单个瓦片地图尺寸，你可以根据自己的游戏场景或者瓦片地图进行对应的设置。还有一个注意点，我在设计最大跳跃宽度和最大跳跃高度的时候，大家应该注意到了，我并没有设置为整数个单元大小，而是会稍微留有一点余地，比如 <code>4.25 * UNIT</code> 而不是 <code>4 * UNIT</code> ，让玩家不会感觉<em>跳上去很难</em>。</p>
<h3 id="添加一些功能"><a href="#添加一些功能" class="headerlink" title="添加一些功能"></a>添加一些功能</h3><p>目前，我们只是完成了最简单的平台跳跃功能，我们需要更加丰富的游戏体验，更加合理的操作设计，让我们再添加一些其他基本功能吧！</p>
<ol>
<li>二次跳跃：在空中进行第二次跳跃，你也可以设置多次</li>
<li>停止跳跃：玩家可以控制主角立即停止跳跃</li>
<li>最低高度：跳跃的最低高度实现</li>
<li>缓冲方案：让起跳和移动不那么唐突</li>
<li>真空死亡：防止无限降落的 BUG</li>
<li>爬梯子：在梯子上玩家能够上下移动</li>
</ol>
<p>小功能虽多，但实现这些小功能的思路并不复杂。对于二次跳跃，当玩家腾空后，也就是允许玩家进行第二次跳跃，这里的二次跳跃一般是不允许无限跳跃的，所以我们需要添加一个条件用于判断是否已经发生了二次跳跃： <code>! isSecondJumping &amp;&amp; ! self.is_on_floor()</code> ，同时，记得在玩家着地后把标记的值进行重置 <code>isSecondJumping = false</code> 即可。</p>
<p>在有的游戏中玩家一旦触发跳跃就会直接跳跃到最大高度，不过这并不是我们所需要的，我们希望玩家可以随时停止跳跃：按下跳跃键起跳，松开跳跃键立即停止！这样玩家就会有一定的跳跃空间可操作，对于平台游戏体验来说还是不错的。<em>停止跳跃</em>功能实现起也不难，我们唯一要做的是监听按键的 <code>released</code> 松开事件并作出相应的处理即可：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">func _input(event):</span><br><span class="line">    <span class="comment"># 跳跃按键松开</span></span><br><span class="line">    <span class="keyword">if</span> event.is_action_released(<span class="string">'jump'</span>):</span><br><span class="line">        <span class="comment"># 玩家垂直速度设 0</span></span><br><span class="line">        velocity.y = <span class="number">0.0</span></span><br></pre></td></tr></table></figure>

<p>但是这会出现第三个问题：如果按键松的太快你会发现玩家好像没有发生过跳跃似的，这样是不是有点太唐突了？嗯，我们应该给玩家一个最小的跳跃高度，也即是说，如果玩家在跳跃上升过程中直接把速度设置为 0 是不行的，相反，我们应该给他一个<em>最小速度</em>： <code>minJumpSpeed</code> ，这个所谓的<em>最小速度</em>和之前的<em>最大速度</em>一样可以使用公式通过已知的<strong>最小高度</strong>值来计算得出。唯一要注意的是：下降过程是不能操作的！</p>
<blockquote>
<p>注意，严格来说这里的<strong>最小高度</strong>术语有误！实际上是在满足玩家没有达到最小速度之前我们就松开了按键，这时我们需要给玩家一个最小的向上跳跃速度而已！这样玩家跳跃的实际高度肯定会超出最小高度！大家可以揣摩体会一下，当然这个设置对游戏来说这并没有什么伤害。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var minJumpSpeed = <span class="number">0.0</span> <span class="comment"># 最小跳跃速度，注意是负数！</span></span><br><span class="line">var minJumpHeight = <span class="number">1.75</span> * UNIT <span class="comment"># 最小跳跃高度，用于计算最小速度</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">func _ready():</span><br><span class="line">    minJumpSpeed = - sqrt(<span class="number">2</span> * gravity * minJumpHeight)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">func _input(event):</span><br><span class="line">    <span class="keyword">if</span> event.is_action_released(<span class="string">'jump'</span>):</span><br><span class="line">        <span class="comment"># 如果速度小于最小跳跃速度，并且不是二次跳跃的情况下设置最小速度</span></span><br><span class="line">        <span class="keyword">if</span> velocity.y &lt; minJumpSpeed &amp;&amp; ! isBonusJumping:</span><br><span class="line">            velocity.y = minJumpSpeed</span><br><span class="line">        <span class="comment"># 二次跳跃直接设置为 0 ，注意是上升过程中</span></span><br><span class="line">        <span class="keyword">elif</span> velocity.y &lt; <span class="number">0.0</span> &amp;&amp; isBonusJumping:</span><br><span class="line">            velocity.y = <span class="number">0.0</span></span><br></pre></td></tr></table></figure>

<p>一些注意点我已经在代码的注释中说明了，注意判断玩家当前跳跃是否为二次跳跃，以及垂直运动的方向是往上还是落下的过程，另外， <code>minJumpSpeed</code> 也是一个负值！</p>
<p>至于第四个和第五个小功能就非常简单了，<em>真空死亡</em>的意思是：如果测试过程中你的地图不小心出现某个漏洞，比如玩家从某个角落跳出了地图的范围，那么他就会因为受到重力加速度的影响导致垂直下落的速度一直增加到无限大（浮点数最大值），这其实已经是 Game Over 了，我们可以在代码中添加一个最大速度值，当玩家超过这个速度直接让游戏结束或者重新开始即可。</p>
<p>对于缓冲方案，这是一个可有可无的部分，只需要一个函数即可搞定： <code>float lerp(float from, float to, float weight)</code> 也就是线性插值计数器，比如我们让玩家移动的时候直接把速度赋值给玩家的移动速度就会有点“鲁莽”，玩家的速度应该从 0 然后快速增长到 <code>moveSpeed</code> 这样会更加合理，这就是插值函数的作用了，在 Unity 中你会发现它的使用更加广泛且常见。</p>
<p>最后一个，对于梯子上的玩家上下移动效果，与水平移动实现起来并没有很大的差别，我们只需要注意梯子上玩家是没有重力加速度的关键点即可：进入梯子清除重力加速度，离开梯子添加重力加速度。具体实现参考代码吧！</p>
<h3 id="辅助效果和所有代码"><a href="#辅助效果和所有代码" class="headerlink" title="辅助效果和所有代码"></a>辅助效果和所有代码</h3><p>我们的玩家跳跃功能已经全部实现了，剩下的是一些辅助特效了。</p>
<ul>
<li>第一个肯定是添加播放合理的动画效果</li>
<li>第二个是音效了，比如跳跃音效，攻击音效，受到伤害的音效等</li>
<li>第三个是玩家受伤害时的屏幕震动特效等</li>
<li>当然，你可以添加更多的效果，比如灰尘粒子等……</li>
</ul>
<p>好了，这么多理论，堆砌到一起，最后看下我们的核心代码吧：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 省略代码……</span></span><br><span class="line"></span><br><span class="line">var _gravity = <span class="number">0.0</span>                  <span class="comment"># 重力加速度，计算获得</span></span><br><span class="line">var _moveSpeed = <span class="number">0.0</span>                <span class="comment"># 水平移动速度，计算获得</span></span><br><span class="line">var _maxJumpSpeed = <span class="number">0.0</span>             <span class="comment"># 最大跳跃度，计算获得</span></span><br><span class="line">var _minJumpSpeed = <span class="number">0.0</span>             <span class="comment"># 最小跳跃速度，计算获得</span></span><br><span class="line">var _maxJumpHeight = <span class="number">4.25</span> * UNIT    <span class="comment"># 最大跳跃高度</span></span><br><span class="line">var _minJumpHeight = <span class="number">1.75</span> * UNIT    <span class="comment"># 最小跳跃高度</span></span><br><span class="line">var _maxRunWidth = <span class="number">5.25</span> * UNIT      <span class="comment"># 最大跨越宽度（飞跃）</span></span><br><span class="line">var _jumpDuration = <span class="number">1.0</span>             <span class="comment"># 空中跳跃时间，上升、降落各占一半</span></span><br><span class="line"></span><br><span class="line">var _isSecondJumping = false        <span class="comment"># 是否为二次跳跃</span></span><br><span class="line">var _secondJumpHeight = <span class="number">1.25</span> * UNIT <span class="comment"># 二次跳跃最大高度</span></span><br><span class="line">var _secondJumpSpeed = <span class="number">0.0</span>          <span class="comment"># 二次跳跃最大速度，计算获得</span></span><br><span class="line"></span><br><span class="line">var velocity = Vector2()            <span class="comment"># 玩家当前度包括x和y方向，计算获得</span></span><br><span class="line"></span><br><span class="line">var _isOnLadder = false             <span class="comment"># 玩家是否在子上</span></span><br><span class="line">var _climbSpeed = <span class="number">0.0</span>               <span class="comment"># 爬梯子速度，根据移动速度计算获得</span></span><br><span class="line">var _nextSoundPlayTime = <span class="number">0.5</span>        <span class="comment"># 水平移动和爬梯子脚步声播放最小时间间隔</span></span><br><span class="line"></span><br><span class="line">var _isAttacked = false             <span class="comment"># 玩家当前是否被攻击了</span></span><br><span class="line">var _isSlashing = false             <span class="comment"># 玩家是否在放冲击波</span></span><br><span class="line">var _currentHealth = <span class="number">3</span>              <span class="comment"># 当前玩家的生命值</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算所有应该计算的数值</span></span><br><span class="line">func _ready():</span><br><span class="line">    _gravity = <span class="number">2</span> * _maxJumpHeight / (_jumpDuration / <span class="number">2</span> * _jumpDuration / <span class="number">2</span>)</span><br><span class="line">    _moveSpeed = _maxRunWidth / _jumpDuration</span><br><span class="line">    _maxJumpSpeed = - _gravity * _jumpDuration / <span class="number">2</span></span><br><span class="line">    _minJumpSpeed = - sqrt(<span class="number">2</span> * _gravity * _minJumpHeight)</span><br><span class="line">    _secondJumpSpeed = - sqrt(<span class="number">2</span> * _gravity * _secondJumpHeight)</span><br><span class="line">    _climbSpeed = _moveSpeed * <span class="number">0.75</span></span><br><span class="line">    self.emit_signal(<span class="string">'health_update'</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理键盘输入</span></span><br><span class="line">func _input(event):</span><br><span class="line">    <span class="comment"># 如果被攻击了，不能继续操作</span></span><br><span class="line">    <span class="keyword">if</span> _isAttacked:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 按下跳跃键</span></span><br><span class="line">    <span class="keyword">if</span> event.is_action_pressed(<span class="string">'jump_up'</span>):</span><br><span class="line">        <span class="keyword">if</span> self.is_on_floor():</span><br><span class="line">            <span class="comment"># 第一次跳跃，在地面上的时候</span></span><br><span class="line">            velocity.y = _maxJumpSpeed</span><br><span class="line">            _playAudioEffect(<span class="string">'jump'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 第二次跳跃，方法内部还有判断</span></span><br><span class="line">            _secondJump()</span><br><span class="line">    <span class="comment"># 松开跳跃键</span></span><br><span class="line">    <span class="keyword">elif</span> event.is_action_released(<span class="string">'jump_up'</span>):</span><br><span class="line">        <span class="keyword">if</span> velocity.y &lt; _minJumpSpeed &amp;&amp; ! _isSecondJumping:</span><br><span class="line">            velocity.y = _minJumpSpeed</span><br><span class="line">        <span class="keyword">elif</span> velocity.y &lt; <span class="number">0.0</span> &amp;&amp; _isSecondJumping:</span><br><span class="line">            velocity.y = <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 攻击键，函数内还有判断</span></span><br><span class="line">    <span class="keyword">if</span> event.is_action_pressed(<span class="string">'shoot'</span>):</span><br><span class="line">        _slash()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">func _physics_process(delta):</span><br><span class="line">    <span class="comment"># 被攻击的情况下依然移动玩家，但是不受键盘控制</span></span><br><span class="line">    <span class="keyword">if</span> _isAttacked:</span><br><span class="line">        velocity.y += _gravity * delta</span><br><span class="line">        self.move_and_slide(velocity, FLOOR_NORMAL)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 在梯子上且不是二次跳跃过程中可以上下移动玩家，同时不会产生重力加速度</span></span><br><span class="line">    var vertical = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> !_isSecondJumping &amp;&amp; _isOnLadder:</span><br><span class="line">        vertical = int(Input.is_action_pressed(<span class="string">'climb_down'</span>)) - int(Input.is_action_pressed(<span class="string">'climb_up'</span>))</span><br><span class="line">        velocity.y = vertical * _climbSpeed</span><br><span class="line">        <span class="keyword">if</span> _nextSoundPlayTime &lt;= <span class="number">0.0</span> &amp;&amp; vertical != <span class="number">0</span>:</span><br><span class="line">            _nextSoundPlayTime = <span class="number">0.5</span></span><br><span class="line">            _playAudioEffect(<span class="string">'climb'</span>)</span><br><span class="line">    <span class="comment"># 不在梯子上则受重力加速度影响，注意即使在梯子上但是是二次跳跃依然会受重力影响而下落</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        velocity.y += _gravity * delta</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 水平移动控制</span></span><br><span class="line">    var horizontal = int(Input.is_action_pressed(<span class="string">'move_right'</span>)) - int(Input.is_action_pressed(<span class="string">'move_left'</span>))</span><br><span class="line">    velocity.x = lerp(velocity.x, horizontal * _moveSpeed, _getRunWeight())</span><br><span class="line"></span><br><span class="line">    velocity = self.move_and_slide(velocity, FLOOR_NORMAL)</span><br><span class="line">    <span class="keyword">if</span> _isSecondJumping &amp;&amp; self.is_on_floor():</span><br><span class="line">        _isSecondJumping = false</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 省略代码，图片方向控制和声效制，动画效果……</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 插值权重：水平移动（0.25）和垂直跳跃（0.2）</span></span><br><span class="line">func _getRunWeight() -&gt; float:</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.25</span> <span class="keyword">if</span> self.is_on_floor() <span class="keyword">else</span> <span class="number">0.2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 二次跳跃</span></span><br><span class="line">func _secondJump():</span><br><span class="line">    <span class="keyword">if</span> _isSecondJumping:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    _isSecondJumping = true</span><br><span class="line">    velocity.y = _secondJumpSpeed</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 省略代码……</span></span><br></pre></td></tr></table></figure>

<p>以上是主要代码部分，建议到我的 Github 仓库克隆源码参考，仓库地址： <a href="https://github.com/spkingr/Godot-Demos" target="_blank" rel="noopener">https://github.com/spkingr/Godot-Demos</a> ，最终的游戏效果：</p>
<p><img src="result_1.gif" alt="效果图"></p>
<h2 id="三、总结（上）"><a href="#三、总结（上）" class="headerlink" title="三、总结（上）"></a>三、总结（上）</h2><p>这是 2019 年的第一篇文章，理论加代码有点超出篇幅了，也陆陆续续花了我不少零零碎碎的闲余时间，希望大家能够从中学到一些知识吧，后续文章我也会努力保持更新速度！</p>
<p>好了，总结一下本文的相关知识：</p>
<ol>
<li>基本的重力加速度相关数学知识</li>
<li>简单的跳跃功能实现</li>
<li>精确高度和跨度的跳跃实现</li>
<li>二次跳跃功能的实现</li>
<li>其他功能的实现</li>
</ol>
<p>本篇涉及到的 Demo 以及相关代码已经上传到 Github ，地址： <a href="https://github.com/spkingr/Godot-Demos" target="_blank" rel="noopener">https://github.com/spkingr/Godot-Demos</a> ， <strong>原创不易</strong>，希望大家喜欢，有疑问多多交流与讨论，随时给我留言！ :smile:</p>
<blockquote>
<p>我的博客地址： <a href="http://liuqingwen.me">http://liuqingwen.me</a> ，我的博客即将同步至腾讯云+社区，邀请大家一同入驻： <a href="https://cloud.tencent.com/developer/support-plan?invite_code=3sg12o13bvwgc" target="_blank" rel="noopener">https://cloud.tencent.com/developer/support-plan?invite_code=3sg12o13bvwgc</a> ，欢迎关注我的微信公众号：<br><img src="https://github.com/spkingr/test-git/raw/master/images/weixin/weixin_it_258.jpg" alt="IT自学不成才"></p>
</blockquote>


<!-- Tags -->



<div class="tags">
    <a href="/tags/Godot/" class="button small">Godot</a>
</div>



<!-- Pre-Next post added by me -->
<!-- Added by me, for pre-post and next-post links in post page -->

    <div class="prev_next clearfix">
      
        <a href="/2019/01/26/introduction-of-godot-3-part-13-the-player-jump-implementation-and-make-a-platform-game-part-2/" class="alignleft prev" title="Godot3游戏引擎入门之十三：实现玩家的跳跃功能并完成一个平台小游戏（下）"><i class="fa fa-angle-double-left"></i>&nbsp;Godot3游戏引擎入门之十三：实现玩家的跳跃功能并完成一个平台小游戏（下）</a>
      
      
        &nbsp;<i class="fa fa-exchange separator"></i>&nbsp;
      
      
        <a href="/2018/12/30/introduction-of-godot-3-part-12-talk-about-collision-and-move-and-collide-vs-move-and-slide-in-kinematicbody2d/" class="alignright next" title="Godot3游戏引擎入门之十二：Godot碰撞理论以及KinematicBody2D的两个方法">Godot3游戏引擎入门之十二：Godot碰撞理论以及KinematicBody2D的两个方法&nbsp;<i class="fa fa-angle-double-right"></i></a>
      
      <div class="clearfix"></div>
    </div>



<!-- Comments -->
<div>
    
    <hr />
    <h3>Comments:</h3>
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
    </div>



</div>



            </div>
        </div>

        <!-- Footer -->
<footer id="footer">
    <div class="inner">
        <section>
            <h2>About</h2>
            <div>
                This theme was initially developed by <a href="http://html5up.net" target="_blank">HTML5 UP</a>. It is adapted for Hexo by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a>. <br/>The source code is available on <a href="https://github.com/klugjo/hexo-theme-phantom" target="_blank">GitHub</a>. <br/><span id="busuanzi_container_site_pv">Total visits:&nbsp;<span id="busuanzi_value_site_pv"></span> , </span><span id="busuanzi_container_site_uv">Number of visitors:&nbsp;<span id="busuanzi_value_site_uv"></span> , staticstics powered by <a href="http://busuanzi.ibruce.info/" target="_blank" title="不蒜子统计">不蒜子</a></span> <br/>Blog post content:&nbsp;<a href="http://liuqingwen.me/tags"><span><i class="fa fa-search"></i>&nbsp;搜索博客内容</span></a>
            </div>
        </section>
        <section>
            <h2>Follow</h2>
            <ul class="icons">
                
                    <li><a href="https://twitter.com/SpkingR" class="icon style2 fa-twitter" target="_blank" ><span class="label">Twitter</span></a></li>
                
                
                
                
                
                    <li><a href="https://github.com/spkingr" class="icon style2 fa-github" target="_blank" ><span class="label">GitHub</span></a></li>
                
                
                    <li><a href="https://plus.google.com/u/0/101955667782244488142" class="icon style2 fa-google-plus" target="_blank" ><span class="label">Google+</span></a></li>
                
                
                
                
                    <li><a href="about/" class="icon style2 fa-envelope-o" target="_blank" ><span class="label">Email</span></a></li>
                
                
                    <li><a href="/atom.xml" class="icon style2 fa-rss" target="_blank" ><span class="label">RSS</span></a></li>
                
            </ul>
            <ul class="links">
                <!-- Added by me, settings in config file -->
                
                    <li><a href="https://zhuanlan.zhihu.com/godot" class="icon style2 zhihu" target="_blank" ><span class="label">知乎</span></a></li>
                
                
                    <li><a href="https://www.jianshu.com/u/756bad579149" class="icon style2 jianshu" target="_blank" ><span class="label">简书</span></a></li>
                
                
                    <li><a href="https://juejin.im/user/59d1d5b1f265da0656048d2b" class="icon style2 juejin" target="_blank" ><span class="label">掘金</span></a></li>
                
                
                    <li><a href="https://blog.csdn.net/SpkingR" class="icon style2 csdn" target="_blank" ><span class="label">CSDN</span></a></li>
                
                
                    <li><a href="https://www.indienova.com/u/liuqingwen" class="icon style2 indienova" target="_blank" ><span class="label">INDIE NOVA</span></a></li>
                
            </ul>
        </section>
        <ul class="copyright">
            <li>&copy; liuqingwen.me. All rights reserved</li>
            <li>Design: <a href="http://html5up.net" target="_blank">HTML5 UP</a></li>
            <li>Hexo: <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></li>
            <li>About Me: <a href="/about">Liuqingwen</a></li>
            <li>备案号: <a href="http://www.beian.miit.gov.cn" target="_blank" rel="noopener">湘ICP备14005092号</a></li>
        </ul>
    </div>
</footer>
    </div>

    <!-- After footer scripts -->
    <!-- jQuery -->

<script src="/js/jquery.min.js"></script>


<!-- skel -->

<script src="/js/skel.min.js"></script>


<!-- Custom Code -->

<script src="/js/util.js"></script>


<!--[if lte IE 8]>

<script src="/js/ie/respond.min.js"></script>

<![endif]-->

<!-- Custom Code -->

<script src="/js/main.js"></script>

<!-- My Custom Code for add lazy-loading-image plugin -->

<script src="/scripts/echo.js"></script>


<script>
    echo.init({
        offset: 100,
        throttle: 250,
        unload: false,
        callback: function (element, op) {
            //Added by me!!! Help to display correctly in Mobile
            /*var entryContentWidth = $(element).width();
            if($(element).width() > entryContentWidth)
            {
                $(element).width("100%");
            }*/
            $(element).css({maxWidth: "100%"});
            // console.log(element, 'has been', op + 'ed');
        }
    });
  // echo.render(); is also available for non-scroll callbacks
</script>

<!-- Added for tipue search plugin....................... -->
<link href="/tipuesearch/css/tipuesearch.css" rel="stylesheet">
<script src="/tipuesearch/tipuesearch_set.js"></script>
<script src="/tipuesearch/tipuesearch.js"></script>
<script>
    $(document).ready(function () {
 
        var searchInput = $('#tipue_search_input');
        searchInput.tipuesearch({
            'mode': 'json',
            'minimumLength': 2,
            'contentLocation': '/tipuesearch/tipuesearch_content.json',
            highlightEveryTerm: true
        });
 
        $('#search-form').on('submit', function (e) {
            e.preventDefault();
            $('#tipue_search_content').show();
            $('#content').hide();
        });
 
        searchInput.keyup(function () {
            var length = $(this).val().length;
            if (length < 1) {
                $('#tipue_search_content').hide();
                $('#content').show();
            }
        });
    });
</script>

<!-- Gallery 
<script src="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.js" type="text/javascript" charset="utf-8"></script> -->
<script src="https://cdn.bootcss.com/featherlight/1.7.13/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->

<script type="text/javascript">
    var disqus_shortname = 'liuqingwen';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


<!-- Calendar -->
<!-- Add by me, the calendar plugin, from: http://howiefh.github.io/2016/04/29/hexo-s-calendar-plugin/ -->

    <script src="/js/calendar.js"></script>
    <script src="/js/languages.js"></script>
    <script type="text/javascript">
        $(function() {
            
                //The same in else! edited by me.....
                $('#calendar').aCalendar('zh-CN',{single:true, root:'calendar/'});
                
                
                    $('#calendar-sample').aCalendar('zh-CN',{single:true, root:'calendar/'});
                
                //Error in the below line:
                //$('#calendar').aCalendar('zh-CN', $.extend(JSON.parse('{"months":["January","February","March","April","May","June","July","August","September","October","November","December"],"dayOfWeekShort":["S","M","T","W","T","F","S"],"dayOfWeek":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"postsMonthTip":"Posts published in LMM yyyy","titleFormat":"yyyy LMM","titleLinkFormat":"/archives/yyyy/MM/","headArrows":{"previous":null,"next":null},"footArrows":{"previous":"«","next":"»"},"weekOffset":0,"single":true,"root":"/calendar/","url":"/calendar.json"}'), {single:true, root:'calendar/'});
            
        });
    </script>


<!-- Calculator of Blog Viewers -->
<!-- Added by me, http://ibruce.info/2015/04/04/busuanzi/ || http://busuanzi.ibruce.info/-->

    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



</body>

</html>